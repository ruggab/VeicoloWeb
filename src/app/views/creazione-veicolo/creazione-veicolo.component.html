<div class="breadcrumb">
  <h1>Gestione Veicolo</h1>
</div>

<div class="separator-breadcrumb border-top"></div>
<div class="row mb-4">
  <div class="col-md-3"></div>
  <div class="col-md-6">
    <div class="card mb-4 noround">
      <div class="card-body">
        <div class="card-title mb-3">Filtro Ricerca Veicolo</div>
        <form [formGroup]="cercaVeicoloForm" (ngSubmit)="cercaVeicolo()">
          <div class="row">
                <div class="col-md-6 form-group mb-3">
                  <label for="matricola">Matricola</label>
                  <input class="form-control" id="matricola" formControlName="matricola" placeholder="Matricola" type="matricola"/>
                </div>
                <div class="col-md-6 form-group mb-3">
                  <label for="telaio">Telaio</label>
                  <input class="form-control" id="telaio" formControlName="telaio" placeholder="Telaio" type="cup"  />
                </div>
                <div class="col-md-6 form-group mb-3 text-center">
                  <label for="assegnatario">Azienda Ass</label>
                  <select class="form-control" id="assegnatario" formControlName="assegnatario"   [compareWith]="compareAzienda">
                    <option [ngValue]="null" *ngIf="isAdmin" ></option>
                    <option [ngValue]="l" *ngFor="let l of listAzienda">{{l.nome}}</option>
                  </select>
                </div>
          </div>
            <br>
            <div class="col-md-12 text-center">
              <btn-loading type="submit" btnClass="btn-primary btn-lg" [loading]="loading">Cerca</btn-loading>
            </div>
         
        </form>
      </div>
    </div>
  </div>

</div>
<br>


<div class="row">
  
  <btn-loading type="button" btnClass="btn btn-info btn-lg" (click)="openLg(modalVeicolo,null)"  *ngIf="isAdmin" >Aggiungi</btn-loading>
  &nbsp;&nbsp;
  <btn-loading type="button" btnClass="btn btn-info btn-lg" (click)="exportCSV()">Esporta CSV</btn-loading>
  
  <table class="table table-bordered" style="margin-top: 5px;">
    <thead class="thead-light">
      <tr>
        <th scope="col">Matricola</th>
        <th scope="col">Telaio</th>
        <th scope="col">Gara</th>
        <th scope="col">Assegnatario</th>
        <th scope="col">Fornitore</th>
        <th scope="col">Modello</th>
        <th scope="col">Categoria</th>
        <th scope="col">Classe</th>
        <th scope="col">Alimentazione</th>
        <th scope="col">Allestimento</th>
        <th scope="col">Targa 1 Imm</th>
        <th scope="col">Data 1 Imm</th>
        <th scope="col"  style="text-align: center;">Azioni</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let l of listVeicolo">
        <th scope="row">{{l.matricola}}</th>
        <td>{{l.telaio}}</td>
        <td>{{l.gara?.codGara}}</td>
        <td>{{l.assegnatario?.nome}}</td>
        <td>{{l.fornitore?.descrizione}}</td>
        <td>{{l.modello?.descrizione}}</td>
        <td>{{l.categoria?.descrizione}}</td>
        <td>{{l.classe?.descrizione}}</td>
        <td>{{l.tipoAlimentazione?.descrizione}}</td>
        <td>{{l.tipoAllestimento?.descrizione}}</td>
        <td>{{l.targa1Imm}}</td>
        <td>{{l.dataPrimaImm}}</td>
        <td style="text-align: center;">
          <button class="btn btn-info btn-lg" (click)="openLg(modalVeicolo, l)" type="button">
            <i class="icon-regular i-Pen-2"></i>
          </button>
          &nbsp;&nbsp;
          <button class="btn btn-info btn-lg" (click)="deleteVeicolo(l.id)" type="button">
            <i class="icon-regular i-Close"></i>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>




<ng-template #modalVeicolo let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Veicolo</h4>

    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row text-center">
        <form [formGroup]="veicoloForm" (ngSubmit)="salvaVeicolo()"   class="mx-auto">
          <input class="form-control" id="id" formControlName="id" type="hidden"  />
          
          <nav ngbNav #nav="ngbNav" class="nav-tabs">
            <ng-container ngbNavItem>
                <a ngbNavLink>Dati Veicolo</a>
                <ng-template ngbNavContent>
                            <div class="row text-center">
                                    <div class="col-md-4 form-group mb-3 text-center">
                                      <label for="matricola">Matricolaa</label>
                                      <input class="form-control" id="matricola" formControlName="matricola" placeholder="Matricola" type="matricola" [ngClass]="{'is-invalid': submitted && f.matricola.errors }" />
                                      <!--div *ngIf="submitted && f.matricola.errors" class="invalid-feedback">
                                        <div *ngIf="f.matricola.errors.required">Matricola obbligataria</div>
                                      </div-->
                                    </div>
                                    <div class="col-md-4 form-group mb-3 text-center">
                                        <label for="telaio">Telaio</label>
                                        <input class="form-control" id="telaio" formControlName="telaio" placeholder="Telaio" type="telaio" [ngClass]="{'is-invalid': submitted && f.telaio.errors }" />
                                        <!--div *ngIf="submitted && f.telaio.errors" class="invalid-feedback">
                                          <div *ngIf="f.telaio.errors.required">Telaio obbligatario!</div>
                                        </div-->
                                    </div>
                                    <div class="col-md-4 form-group mb-3 text-center">
                                      <label for="fornitore">Fornitore</label>
                                      <select class="form-control" id="fornitore" formControlName="fornitore"   [compareWith]="compareFn">
                                        <option [ngValue]="null" ></option>
                                        <option [ngValue]="l" *ngFor="let l of listFornitore">{{l.descrizione}}</option>
                                      </select>
                                    </div>
                           
                               
                                  <div class="col-md-4 form-group mb-3 text-center">
                                    <label for="categoria">Categoria</label>
                                    <select class="form-control" id="categoria" formControlName="categoria"   [compareWith]="compareFn">
                                      <option [ngValue]="null" ></option>
                                      <option [ngValue]="l" *ngFor="let l of listCategoria">{{l.descrizione}}</option>
                                    </select>
                                  </div>
                           
                                  <div class="col-md-4 form-group mb-3 text-center">
                                    <label for="classe">Classe</label>
                                    <select class="form-control" id="classe" formControlName="classe"   [compareWith]="compareFn">
                                      <option [ngValue]="null" ></option>
                                      <option [ngValue]="l" *ngFor="let l of listClasse">{{l.descrizione}}</option>
                                    </select>
                                  </div>

                                  <div class="col-md-4 form-group mb-3 text-center">
                                    <label for="classeAmbientale">Classe Ambientale</label>
                                    <select class="form-control" id="classeAmbientale" formControlName="classeAmbientale"   [compareWith]="compareFn">
                                      <option [ngValue]="null" ></option>
                                      <option [ngValue]="l" *ngFor="let l of listClasseAmb">{{l.descrizione}}</option>
                                    </select>
                                  </div>
                                         
                                  <div class="col-md-4 form-group mb-3 text-center">
                                    <label for="modello">Modello</label>
                                    <select class="form-control" id="modello" formControlName="modello"   [compareWith]="compareFn">
                                      <option [ngValue]="null" ></option>
                                      <option [ngValue]="l" *ngFor="let l of listModello">{{l.descrizione}}</option>
                                    </select>
                                  </div>   
                                  
                                  <div class="col-md-4 form-group mb-3 text-center">
                                    <label for="tipoAlimentazione">Tipo Alimentazione</label>
                                    <select class="form-control" id="tipoAlimentazione" formControlName="tipoAlimentazione"   [compareWith]="compareFn">
                                      <option [ngValue]="null" ></option>
                                      <option [ngValue]="l" *ngFor="let l of listAlimentazione">{{l.descrizione}}</option>
                                    </select>
                                  </div>
                                  <div class="col-md-4 form-group mb-3 text-center">
                                    <label for="tipoAllestimento">Tipo Allestimento</label>
                                    <select class="form-control" id="tipoAllestimento" formControlName="tipoAllestimento"   [compareWith]="compareFn">
                                      <option [ngValue]="null" ></option>
                                      <option [ngValue]="l" *ngFor="let l of listAllestimento">{{l.descrizione}}</option>
                                    </select>
                                  </div>

                               
                        
                                      <div class="col-md-2 form-group mb-3 text-center">
                                        <label for="lunghezza">Lunghezza</label>
                                        <input class="form-control" id="lunghezza" formControlName="lunghezza" placeholder="Lunghezza" type="lunghezza" [ngClass]="{'is-invalid': submitted && f.lunghezza.errors }" />                  
                                      </div>
                                      <div class="col-md-2 form-group mb-3 text-center">
                                          <label for="numPorte">Numero Porte</label>
                                          <input class="form-control" id="numPorte" formControlName="numPorte" placeholder="Numero Porte" type="numPorte" [ngClass]="{'is-invalid': submitted && f.numPorte.errors }" />              
                                      </div>
                                      <div class="col-md-4 form-group mb-3 text-center">
                                          <label for="targa1imm">Targa 1 Immatricolazione</label>
                                          <input class="form-control" id="targa1imm" formControlName="targa1imm" placeholder="Targa" type="targa1imm"  />
                                          <!--div *ngIf="submitted && f.targa1imm.errors" class="invalid-feedback">
                                            <div *ngIf="f.targa1imm.errors.required">Targa obbligatoria!</div>
                                          </div-->
                                      </div>
                                      <div class="col-md-4 form-group mb-3 text-center">
                                        <label for="dataPrimaImm">Data I Immatricolazione</label>
                                        <div class="input-group">
                                            <input class="form-control" id="dataPrimaImm"  formControlName="dataPrimaImm"  ngbDatepicker #d="ngbDatepicker"  tabindex="-1">
                                            <div class="input-group-append">
                                                <button class="btn btn-outline-secondary calendar" (click)="d.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                            </div>
                                        </div>
                                      </div>
                           
                                    <div class="col-md-4 form-group mb-3 text-center">
                                        <label for="numSimSerialNumber">Numero SIM Serial N.</label>
                                        <input class="form-control" id="numSimSerialNumber" formControlName="numSimSerialNumber" placeholder="SIM Serial N." type="numSimSerialNumber" [ngClass]="{'is-invalid': submitted && f.numSimSerialNumber.errors }" />              
                                    </div>
                                    <div class="col-md-4 form-group mb-3 text-center">
                                      <label for="numSimTelefonico">Sim Tel.</label>
                                      <input class="form-control" id="numSimTelefonico" formControlName="numSimTelefonico" placeholder="Sim Tel." type="numSimTelefonico" [ngClass]="{'is-invalid': submitted && f.numSimTelefonico.errors }" />              
                                    </div>
                                   
                            </div>
                            
                </ng-template>
              </ng-container>

              <ng-container ngbNavItem>
                <a ngbNavLink>Info Veicolo</a>
                <ng-template ngbNavContent>
                   
                      <div class="row text-center">

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="gara">Gara</label>
                            <select class="form-control" id="gara" formControlName="gara"   [compareWith]="compareGara">
                              <option [ngValue]="null" ></option>
                              <option [ngValue]="l" *ngFor="let l of listGara">{{l.codGara}}</option>
                            </select>
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="assegnatario">Azienda Assegnataria</label>
                            <select class="form-control" id="assegnatario" formControlName="assegnatario"   [compareWith]="compareAzienda">
                              <option [ngValue]="null" *ngIf="isAdmin" ></option>
                              <option [ngValue]="l" *ngFor="let l of listAzienda">{{l.nome}}</option>
                            </select>
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="determAssegnazione">Determina Assegnazione</label>
                            <input class="form-control" id="determAssegnazione" formControlName="determAssegnazione" placeholder="Determina Assegnazione" type="determAssegnazione" [ngClass]="{'is-invalid': submitted && f.determAssegnazione.errors }" />              
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="dataConsegnaAziendaTpl">Data Consegna TPL</label>
                            <div class="input-group">
                                <input class="form-control" id="dataConsegnaAziendaTpl" formControlName="dataConsegnaAziendaTpl" ngbDatepicker #d4="ngbDatepicker"  tabindex="-1">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary calendar" (click)="d4.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                </div>
                            </div>
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="dataContrattoAssegnAziendaTpl">Data Contratto Assegnazione Azienda TPL</label>
                            <div class="input-group">
                                <input class="form-control" id="dataContrattoAssegnAziendaTpl" formControlName="dataContrattoAssegnAziendaTpl" ngbDatepicker #dca="ngbDatepicker"  tabindex="-1">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary calendar" (click)="dca.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                </div>
                            </div>
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="dataContrattoApplAziendaTpl">Data Contratto Applicativo Assegnazione Azienda TPL</label>
                            <div class="input-group">
                                <input class="form-control" id="dataContrattoApplAziendaTpl" formControlName="dataContrattoApplAziendaTpl" ngbDatepicker #dcaa="ngbDatepicker"  tabindex="-1">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary calendar" (click)="dcaa.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                </div>
                            </div>
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="dataAttivazioneAvm">Data Attivazione AVM</label>
                            <div class="input-group">
                                <input class="form-control" id="dataAttivazioneAvm" formControlName="dataAttivazioneAvm" ngbDatepicker #davm="ngbDatepicker"  tabindex="-1">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary calendar" (click)="davm.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                </div>
                            </div>
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="regimeProprieta">Regime Proprieta</label>
                            <select class="form-control" id="regimeProprieta" formControlName="regimeProprieta"   [compareWith]="compareFn">
                              <option [ngValue]="null" ></option>
                              <option [ngValue]="l" *ngFor="let l of listRegimeProprieta">{{l.descrizione}}</option>
                            </select>
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="costoAcquistoNettoIva">Costo Acquisto Netto Iva €</label>
                            <input class="form-control" id="costoAcquistoNettoIva" formControlName="costoAcquistoNettoIva" placeholder="Costo Acquisto" type="costoAcquistoNettoIva" [ngClass]="{'is-invalid': submitted && f.costoAcquistoNettoIva.errors }" />              
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                              <label for="numProtocolloRicovero">N. Protocollo Ricovero</label>
                              <input class="form-control" id="numProtocolloRicovero" formControlName="numProtocolloRicovero" placeholder="N. Protocollo Ricovero" type="numProtocolloRicovero" [ngClass]="{'is-invalid': submitted && f.numProtocolloRicovero.errors }" />              
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="protArrivoAcamMessADispCons">Protocollo Arrivo Acamir Messa a Disposizione Consegna</label>
                            <input class="form-control" id="protArrivoAcamMessADispCons" formControlName="protArrivoAcamMessADispCons" placeholder="N. Protocollo Arrivo Acamir" type="protArrivoAcamMessADispCons" [ngClass]="{'is-invalid': submitted && f.protArrivoAcamMessADispCons.errors }" />              
                         </div>

                         <div class="col-md-4 form-group mb-3 text-center">
                          <label for="protComSituazApparati">Protocollo Situazione Apparati</label>
                          <input class="form-control" id="protComSituazApparati" formControlName="protComSituazApparati" placeholder="Protocollo Situazione Apparati" type="protComSituazApparati" [ngClass]="{'is-invalid': submitted && f.protComSituazApparati.errors }" />              
                         </div>

                         <div class="col-md-4 form-group mb-3 text-center">
                          <label for="dataScadTassaPossesso">Data Scadenza Tassa Possesso</label>
                          <div class="input-group">
                              <input class="form-control" id="dataScadTassaPossesso" formControlName="dataScadTassaPossesso" ngbDatepicker #dstp="ngbDatepicker"  tabindex="-1">
                              <div class="input-group-append">
                                  <button class="btn btn-outline-secondary calendar" (click)="dstp.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                              </div>
                          </div>
                        </div>

                        <div class="col-md-4 form-group mb-3 text-center">
                          <label for="dataScadRca">Data Scadenza RCA</label>
                          <div class="input-group">
                              <input class="form-control" id="dataScadRca" formControlName="dataScadRca" ngbDatepicker #dsrca="ngbDatepicker"  tabindex="-1">
                              <div class="input-group-append">
                                  <button class="btn btn-outline-secondary calendar" (click)="dsrca.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                              </div>
                          </div>
                        </div>
                    
                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="dataUltimaVerificaIsp">Data Ultima Verifica Ispettiva</label>
                            <div class="input-group">
                                <input class="form-control" id="dataUltimaVerificaIsp" formControlName="dataUltimaVerificaIsp" ngbDatepicker #duvi="ngbDatepicker"  tabindex="-1">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary calendar" (click)="duvi.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                </div>
                            </div>
                          </div>
                          <div class="col-md-12 form-group mb-3 text-center">
                            <label for="estremiProtRappVerIsp">Estremi Protocollo Rapporto Verifica Ispettiva</label>
                            <input class="form-control" id="estremiProtRappVerIsp" formControlName="estremiProtRappVerIsp" placeholder="Estremi Protocollo Rapporto Verifica Ispettiva" type="note" [ngClass]="{'is-invalid': submitted && f.estremiProtRappVerIsp.errors }" />              
                          </div>
                          <div class="col-md-12 form-group mb-3 text-center">
                              <label for="noteVerificaIsp">Note Verifica Ispettiva</label>
                              <input class="form-control" id="noteVerificaIsp" formControlName="noteVerificaIsp" placeholder="Note Verifica Ispettiva" type="note" [ngClass]="{'is-invalid': submitted && f.noteVerificaIsp.errors }" />              
                          </div>
                      </div>


                </ng-template>
              </ng-container>     

              <ng-container ngbNavItem>
                <a ngbNavLink>Dati Usufrutto</a>
                <ng-template ngbNavContent>
                  
                    <div class="row text-center"> 
                            <div class="col-md-4 form-group mb-3 text-center">
                              <label for="estremiContrUsufrutto">Estremi Contratto Usufrutto</label>
                              <input class="form-control" id="estremiContrUsufrutto" formControlName="estremiContrUsufrutto" placeholder="Estremi" type="estremiContrUsufrutto" [ngClass]="{'is-invalid': submitted && f.estremiContrUsufrutto.errors }" />              
                            </div>  
                            <div class="col-md-4 form-group mb-3 text-center">
                                <label for="dataContrUsufrutto">Data Contratto Usufrutto</label>
                                <div class="input-group">
                                    <input class="form-control" id="dataContrUsufrutto" formControlName="dataContrUsufrutto" ngbDatepicker #d5="ngbDatepicker"  tabindex="-1">
                                    <div class="input-group-append">
                                        <button class="btn btn-outline-secondary calendar" (click)="d5.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                    </div>
                                </div>
                            </div>          
                            <div class="col-md-4 form-group mb-3 text-center">
                                <label for="dataScadUsufrutto">Data Scadenza Usufrutto</label>
                                <div class="input-group">
                                    <input class="form-control" id="dataScadUsufrutto" formControlName="dataScadUsufrutto" ngbDatepicker #d6="ngbDatepicker"  tabindex="-1">
                                    <div class="input-group-append">
                                        <button class="btn btn-outline-secondary calendar" (click)="d6.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                    </div>
                                </div>
                            </div>
                         
                 
                            <div class="col-md-4 form-group mb-3 text-center">
                              <label for="valAnnuoCanone">Valore Annuo Canone €</label>
                              <input class="form-control" id="valAnnuoCanone" formControlName="valAnnuoCanone" placeholder="Canone Annuo" type="number" [ngClass]="{'is-invalid': submitted && f.valAnnuoCanone.errors }" />              
                            </div>  
                            <div class="col-md-4 form-group mb-3 text-center">
                              <label for="valPrimoCanone">Valore Primo Canone €</label>
                              <input class="form-control" id="valPrimoCanone" formControlName="valPrimoCanone" placeholder="Primo Canone" type="number" [ngClass]="{'is-invalid': submitted && f.valPrimoCanone.errors }" />              
                            </div>         
                            <div class="col-md-4 form-group mb-3 text-center">
                              <label for="valDa2a8Canone">Valore Canone da 2 a 8 €</label>
                              <input class="form-control" id="valDa2a8Canone" formControlName="valDa2a8Canone" placeholder="Canone da 2 a 8" type="number" [ngClass]="{'is-invalid': submitted && f.valDa2a8Canone.errors }" />              
                            </div> 


                            <div class="col-md-4 form-group mb-3 text-center">
                              <label for="val9Canone">Valore Canone 9 €</label>
                              <input class="form-control" id="val9Canone" formControlName="val9Canone" placeholder="Canone 9" type="number" [ngClass]="{'is-invalid': submitted && f.val9Canone.errors }" />              
                            </div>  
                            <div class="col-md-4 form-group mb-3 text-center">
                              <label for="val10Canone">Valore Canone 10 €</label>
                              <input class="form-control" id="val10Canone" formControlName="val10Canone" placeholder="Canone 10" type="number" [ngClass]="{'is-invalid': submitted && f.val10Canone.errors }" />              
                            </div>         
                            <div class="col-md-4 form-group mb-3 text-center">
                              <label for="val11Canone">Valore Canone 11 €</label>
                              <input class="form-control" id="val11Canone" formControlName="val11Canone" placeholder="Canone 11" type="number" [ngClass]="{'is-invalid': submitted && f.val11Canone.errors }" />              
                            </div> 

                    </div>
                </ng-template>
              </ng-container> 
              <ng-container ngbNavItem>
                <a ngbNavLink>Polizze e Garanzie</a>
                <ng-template ngbNavContent>
                      <div class="row text-center">

                          <div class="col-md-6 form-group mb-3 text-center">
                            <label for="protFidGaranziaBase">Prot Arrivo ACaMIR polizza fideiussoria garanzia base</label>
                            <input class="form-control" id="protFidGaranziaBase" formControlName="protFidGaranziaBase" placeholder="Prot Garanzia Base" type="protFidGaranziaBase" [ngClass]="{'is-invalid': submitted && f.protFidGaranziaBase.errors }" />              
                          </div>
                          
                          <div class="col-md-6 form-group mb-3 text-center">
                            <label for="protFidGaranziaEstesa">Prot Arrivo ACaMIR polizza fideiussoria garanzia estesa</label>
                            <input class="form-control" id="protFidGaranziaEstesa" formControlName="protFidGaranziaEstesa" placeholder="Prot Garanzia Estesa" type="protFidGaranziaEstesa" [ngClass]="{'is-invalid': submitted && f.protFidGaranziaEstesa.errors }" />              
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="numPolGaranziaBase">Numero polizza garanzia di base</label>
                            <input class="form-control" id="numPolGaranziaBase" formControlName="numPolGaranziaBase" placeholder="Num Polizza Base" type="numPolGaranziaBase" [ngClass]="{'is-invalid': submitted && f.numPolGaranziaBase.errors }" />              
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="dataScadPolGaranziaBase">Data Scadenza Polizza Garanzia Base</label>
                            <div class="input-group">
                                <input class="form-control" id="dataScadPolGaranziaBase" formControlName="dataScadPolGaranziaBase" ngbDatepicker #dspgb="ngbDatepicker"  tabindex="-1">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary calendar" (click)="dspgb.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                </div>
                            </div>
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="dataScadGaranziaBase">Data Scadenza Garanzia Base</label>
                            <div class="input-group">
                                <input class="form-control" id="dataScadGaranziaBase" formControlName="dataScadGaranziaBase" ngbDatepicker #dsgb="ngbDatepicker"  tabindex="-1">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary calendar" (click)="dsgb.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                </div>
                            </div>
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="numPolGaranziaEstesa">Numero polizza garanzia estesa</label>
                            <input class="form-control" id="numPolGaranziaEstesa" formControlName="numPolGaranziaEstesa" placeholder="Num Polizza Estesa" type="numPolGaranziaEstesa" [ngClass]="{'is-invalid': submitted && f.numPolGaranziaEstesa.errors }" />              
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="dataScadPolGaranziaEstesa">Data Scadenza Polizza Garanzia Estesa</label>
                            <div class="input-group">
                                <input class="form-control" id="dataScadPolGaranziaEstesa" formControlName="dataScadPolGaranziaEstesa" ngbDatepicker #dspge="ngbDatepicker"  tabindex="-1">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary calendar" (click)="dspge.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                </div>
                            </div>
                          </div>

                          <div class="col-md-4 form-group mb-3 text-center">
                            <label for="dataScadGaranziaEstesa">Data Scadenza Garanzia Estesa</label>
                            <div class="input-group">
                                <input class="form-control" id="dataScadGaranziaEstesa" formControlName="dataScadGaranziaEstesa" ngbDatepicker #dsge="ngbDatepicker"  tabindex="-1">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary calendar" (click)="dsge.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                </div>
                            </div>
                          </div>

                        
                      </div>
                </ng-template>
              </ng-container> 
              <ng-container ngbNavItem>
                <a ngbNavLink>Azienda TPL</a>
                <ng-template ngbNavContent>
                      <div class="row text-center">

                                <div class="col-md-4 form-group mb-3 text-center">
                                  <label for="contrattoServizio">Contratto Servizio</label>
                                  <input class="form-control" id="contrattoServizio" formControlName="contrattoServizio" placeholder="Contratto Servizio" type="contrattoServizio" [ngClass]="{'is-invalid': submitted && f.contrattoServizio.errors }" />              
                                </div>

                                <div class="col-md-4 form-group mb-3 text-center">
                                  <label for="kmDataRevisione">Km Data Revisione</label>
                                  <input class="form-control" id="kmDataRevisione" formControlName="kmDataRevisione" placeholder="Km" type="kmDataRevisione" [ngClass]="{'is-invalid': submitted && f.kmDataRevisione.errors }" />              
                                </div>

                                <div class="col-md-4 form-group mb-3 text-center">
                                  <label for="dataUltimaRevisione">Data Ultima Revisione</label>
                                  <div class="input-group">
                                      <input class="form-control" id="dataUltimaRevisione" formControlName="dataUltimaRevisione"  ngbDatepicker #d7="ngbDatepicker"  tabindex="-1">
                                      <div class="input-group-append">
                                          <button class="btn btn-outline-secondary calendar" (click)="d7.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                      </div>
                                  </div>
                                </div>

                                <div class="col-md-4 form-group mb-3 text-center">
                                  <label for="dataCessMarcia">Data Cessazione Marcia</label>
                                  <div class="input-group">
                                      <input class="form-control" id="dataCessMarcia" formControlName="dataCessMarcia"  ngbDatepicker #d8="ngbDatepicker"  tabindex="-1">
                                      <div class="input-group-append">
                                          <button class="btn btn-outline-secondary calendar" (click)="d8.toggle()" type="button"><i class="icon-regular i-Calendar-4"></i></button>
                                      </div>
                                  </div>
                                </div>

                                <div class="col-md-4 form-group mb-3 text-center">
                                  <label for="indirizzoDepositoRicovero">Indirizzo Ricovero</label>
                                  <input class="form-control" id="indirizzoDepositoRicovero" formControlName="indirizzoDepositoRicovero" placeholder="Indirizzo Ricovero" type="indirizzoDepositoRicovero" [ngClass]="{'is-invalid': submitted && f.indirizzoDepositoRicovero.errors }" />              
                                </div>

                                <div class="col-md-4 form-group mb-3 text-center">
                                  <label for="motivoFermo">Motivazione Fermo</label>
                                  <input class="form-control" id="motivoFermo" formControlName="motivoFermo" placeholder="Motivazione Fermo" type="motivoFermo" [ngClass]="{'is-invalid': submitted && f.indirizzoDepositoRicovero.errors }" />              
                                </div>

                               
                      </div>        
                </ng-template>
              </ng-container>
            </nav>
            <div [ngbNavOutlet]="nav" class="mt-2"></div>
          <br>

          <div class="col-md-12 text-center">
            <btn-loading type="submit" btnClass="btn btn-primary mt-2" [loading]="loading2" >Salva</btn-loading>
          </div>
       </form>

    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-dark btn-rounded" (click)="modal.close('ok')">Chiudi</button>
  </div>
</ng-template>


<div class="module-loader" *ngIf="moduleLoading">
  <div class="spinner spinner-bubble spinner-bubble-primary mr-3"></div>
</div>

<div class="module-loader" *ngIf="loadingcsv">
  <div class="spinner spinner-bubble spinner-bubble-primary mr-3"></div>
</div>